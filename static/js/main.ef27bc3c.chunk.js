(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{248:function(e,t){},292:function(e,t,n){e.exports=n(680)},318:function(e,t){},320:function(e,t){},359:function(e,t){},360:function(e,t){},383:function(e,t){},585:function(e,t){},600:function(e,t){},638:function(e,t){},678:function(e,t,n){},680:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n.n(r),c=n(284),i=n(47),s=n(34),o=n(289),u=n(291),p=n(35),l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{items:[],loading:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PENDING":case"DELETE_PENDING":case"CREATE_PENDING":case"UPDATE_PENDING":return Object(p.a)({},e,{loading:!0});case"FETCH_SUCCESS":return{items:t.payload.reverse(),loading:!1};case"FETCH_FAILURE":return{items:[],loading:!1};case"DELETE_SUCCESS":var n=t.id;return{items:e.items.filter(function(e){return e.id!==n}),loading:!1};case"CREATE_SUCCESS":return{items:[t.payload].concat(e.items),loading:!1};case"UPDATE_SUCCESS":var r=t.payload,a=r.id,c=Object(u.a)(r,["id"]);return{items:e.items.map(function(e){return e.id===a?Object(p.a)({},e,c):e}),loading:!1};case"CREATE_FAILURE":case"DELETE_FAILURE":case"UPDATE_FAILURE":return Object(p.a)({},e,{loading:!1});default:return e}},d=Object(i.c)({snippets:l}),f=n(6),h=n.n(f),m=n(9),E=n(290),b=n(49),v=n(32),y=n(33),O=n(288),S=n.n(O),j=n(1).Buffer,x=new(function(){function e(){Object(v.a)(this,e),this.lsName="ipfs-editor",this.ipfs=S()("ipfs.infura.io","5001",{protocol:"https"})}return Object(y.a)(e,[{key:"getFromIpfs",value:function(){var e=Object(b.a)(h.a.mark(function e(t){var n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ipfs.files.get(t);case 2:return n=e.sent,e.abrupt("return",n[0].content.toString("utf8"));case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveToIpfs",value:function(){var e=Object(b.a)(h.a.mark(function e(t){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new j(t),e.next=3,this.ipfs.files.add(n);case 3:return r=e.sent,e.abrupt("return",r[0].hash);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fetch",value:function(){var e=Object(b.a)(h.a.mark(function e(){var t=this;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.snippets.map(function(){var e=Object(b.a)(h.a.mark(function e(n){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=p.a,e.t1={},e.t2=n,e.next=5,t.getFromIpfs(n.id);case 5:return e.t3=e.sent,e.t4={body:e.t3},e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t4));case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(b.a)(h.a.mark(function e(t){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.saveToIpfs(t.body);case 3:n=e.sent,e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",null);case 9:return r={id:n,title:t.title,updatedAt:Date.now()},this.snippets=Object(E.a)(this.snippets).concat([r]),e.abrupt("return",Promise.resolve(Object(p.a)({},r,{body:t.body})));case 12:case"end":return e.stop()}},e,this,[[0,6]])}));return function(t){return e.apply(this,arguments)}}()},{key:"update",value:function(){var e=Object(b.a)(h.a.mark(function e(t){var n,r;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveToIpfs(t.body);case 2:return n=e.sent,(r=this.snippets).filter(function(e){return e.title===t.title}).forEach(function(e){e.id=n,e.body=t.body,e.updatedAt=Date.now()}),this.snippets=r,e.abrupt("return",Object(p.a)({},t,{id:n}));case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(b.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.snippets.find(function(e){return e.id!==t})){e.next=2;break}return e.abrupt("return",!1);case 2:return this.snippets=this.snippets.filter(function(e){return e.id!==t}),e.abrupt("return",!0);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"snippets",get:function(){var e=[];try{if(e=JSON.parse(window.localStorage[this.lsName]),!Array.isArray(e))throw new Error("snippets are not array")}catch(t){this.snippets=[]}return e},set:function(e){window.localStorage[this.lsName]=JSON.stringify(e)}}]),e}());function w(){return x.fetch()}function N(e){return x.delete(e)}function C(e){return x.create(e)}function _(e){return x.update(e)}var g=n(48),T=Object(g.a)();function k(e){T.push(e)}function D(e){return e.snippets}function A(e,t){return e.snippets.items.find(function(e){return e.id===t})}var I=h.a.mark(R),F=h.a.mark(L),U=h.a.mark(H),P=h.a.mark(G);function R(){var e;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.c)({type:"FETCH_PENDING"});case 2:return t.prev=2,t.next=5,Object(m.b)(w);case 5:return e=t.sent,t.next=8,Object(m.c)({type:"FETCH_SUCCESS",payload:e});case 8:t.next=17;break;case 10:return t.prev=10,t.t0=t.catch(2),t.next=14,Object(m.c)({type:"FETCH_FAILURE"});case 14:return console.error(t.t0),t.next=17,Object(m.c)(k("/error"));case 17:case"end":return t.stop()}},I,this,[[2,10]])}function L(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)("FETCH",R);case 2:case"end":return e.stop()}},F,this)}function H(){var e;return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.d)(D);case 2:if(e=t.sent,e.items.length){t.next=7;break}return t.next=7,Object(m.b)(R);case 7:case"end":return t.stop()}},U,this)}function G(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)("FETCH_IF_NEEDED",H);case 2:case"end":return e.stop()}},P,this)}var B=h.a.mark(M),J=h.a.mark(X);function M(e){return h.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(m.c)({type:"DELETE_PENDING",id:e.id});case 2:return t.prev=2,t.next=5,Object(m.b)(N,e.id);case 5:return t.next=7,Object(m.c)({type:"DELETE_SUCCESS",id:e.id});case 7:t.next=16;break;case 9:return t.prev=9,t.t0=t.catch(2),t.next=13,Object(m.c)({type:"DELETE_FAILURE"});case 13:return console.error(t.t0),t.next=16,Object(m.c)(k("/error"));case 16:case"end":return t.stop()}},B,this,[[2,9]])}function X(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)("DELETE",M);case 2:case"end":return e.stop()}},J,this)}var q=h.a.mark(z),V=h.a.mark(K);function z(e){var t;return h.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(m.c)({type:"CREATE_PENDING"});case 2:return n.prev=2,n.next=5,Object(m.b)(C,e.payload);case 5:return t=n.sent,n.next=8,Object(m.c)({type:"CREATE_SUCCESS",payload:t});case 8:k("/home/snippets"),n.next=18;break;case 11:return n.prev=11,n.t0=n.catch(2),n.next=15,Object(m.c)({type:"CREATE_FAILURE"});case 15:return console.error(n.t0),n.next=18,Object(m.c)(k("/error"));case 18:case"end":return n.stop()}},q,this,[[2,11]])}function K(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)("CREATE",z);case 2:case"end":return e.stop()}},V,this)}var Q=h.a.mark(Y),W=h.a.mark(Z);function Y(e){var t;return h.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(m.c)({type:"UPDATE_PENDING"});case 2:return n.prev=2,n.next=5,Object(m.b)(_,e.payload);case 5:return t=n.sent,n.next=8,Object(m.c)({type:"UPDATE_SUCCESS",payload:t});case 8:return n.next=10,Object(m.c)({type:"FETCH"});case 10:k("/home/snippets"),n.next=20;break;case 13:return n.prev=13,n.t0=n.catch(2),n.next=17,Object(m.c)({type:"UPDATE_FAILURE"});case 17:return console.error(n.t0),n.next=20,Object(m.c)(k("/error"));case 20:case"end":return n.stop()}},Q,this,[[2,13]])}function Z(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.e)("UPDATE",Y);case 2:case"end":return e.stop()}},W,this)}var $=h.a.mark(ee);function ee(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)([G(),L(),X(),K(),Z()]);case 2:case"end":return e.stop()}},$,this)}var te=n(683),ne=n(684),re=n(685),ae=n(682),ce=n(681),ie=n(45),se=n(44),oe=n(46),ue="FETCH",pe="FETCH_IF_NEEDED",le="DELETE",de="UPDATE";function fe(e){var t=e.loading,n=e.snippets,r=e.onNewSnippet,c=e.onReloadSnippets;return a.a.createElement("div",null,a.a.createElement("div",{className:"snippets-heading"},a.a.createElement("h2",{className:"snippets-heading__title"},"Snippets"),a.a.createElement("button",{className:"btn snippets-heading__btn",onClick:r,disabled:t},"New Snippet"),a.a.createElement("button",{className:"btn snippets-heading__btn",onClick:c,disabled:t||0===n.length},a.a.createElement("i",{className:"fa fa-refresh"}))))}function he(e){var t=e.loading,n=e.snippets,r=e.url,c=e.onEditSnippet,i=e.onDeleteSnippet;return t?a.a.createElement("p",null,"Loading..."):0===n.length?a.a.createElement("div",null,"No snippets."):a.a.createElement("ul",{className:"snippets"},n.map(function(e){return a.a.createElement("li",{className:"snippets__item",key:e.id},a.a.createElement(ce.a,{className:"snippets__title",to:"".concat(r,"/").concat(e.id)},e.title),a.a.createElement("button",{className:"btn snippets__btn",onClick:function(){return c(e.id)},title:"Edit"},a.a.createElement("i",{className:"fa fa-pencil-square-o"})),a.a.createElement("button",{className:"btn snippets__btn",onClick:function(){return i(e.id)},title:"Delete"},a.a.createElement("i",{className:"fa fa-trash-o"})))}))}var me=function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(ie.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(a)))).handleDeleteSnippet=function(e){window.confirm("Do you want to delete this text snippet?")&&n.props.deleteSnippet(e)},n.handleNewSnippet=function(){var e=n.props.match.url;k("".concat(e,"/new"))},n.handleEditSnippet=function(e){var t=n.props.match.url;k("".concat(t,"/").concat(e,"/edit"))},n.handleReloadSnippets=function(){n.props.fetchSnippets()},n}return Object(oe.a)(t,e),Object(y.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchSnippetsIfNeeded()}},{key:"render",value:function(){var e=this.props.snippets,t=e.items,n=e.loading,r=this.props.match.url;return a.a.createElement("div",null,a.a.createElement(fe,{loading:n,snippets:t,onNewSnippet:this.handleNewSnippet,onReloadSnippets:this.handleReloadSnippets}),a.a.createElement(he,{loading:n,snippets:t,url:r,onEditSnippet:this.handleEditSnippet,onDeleteSnippet:this.handleDeleteSnippet}))}}]),t}(r.Component);var Ee=Object(s.b)(function(e){return{snippets:D(e)}},function(e){return{fetchSnippetsIfNeeded:function(){return e({type:pe})},deleteSnippet:function(t){return e({type:le,id:t})},fetchSnippets:function(){return e({type:ue})}}})(me),be=function(e){function t(e){var n,r;Object(v.a)(this,t),(r=Object(ie.a)(this,Object(se.a)(t).call(this,e))).handleTitleChange=function(e){var t=e.currentTarget.value;r.setState(function(){return{title:t}})},r.handleBodyChange=function(e){var t=e.currentTarget.value;r.setState(function(){return{body:t}})},r.handleSubmit=function(e){e.preventDefault();var t=r.state,n=t.title,a=t.body;if(n=n.trim(),a=a.trim(),n&&a){a.length>3e3?r.setState(function(){return{error:"Body is too long (max. ".concat(3e3," characters)")}}):(r.setState(function(){return{error:""}}),r.props.onSubmit({title:n,body:a}))}else r.setState(function(){return{error:"Please provide both title and body."}})};var a="",c="";return r.props.snippet&&(a=(n=r.props.snippet).title,c=n.body),r.state={title:a,body:c,error:""},r}return Object(oe.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.state,t=e.title,n=e.body,r=e.error;return a.a.createElement("div",null,r&&a.a.createElement("div",{className:"form-error"},r),a.a.createElement("form",{className:"form",onSubmit:this.handleSubmit},a.a.createElement("div",{className:"field field-text"},a.a.createElement("label",{htmlFor:"title"},"Title:",a.a.createElement("input",{type:"text",id:"title",value:t,onChange:this.handleTitleChange}))),a.a.createElement("div",{className:"field field-text"},a.a.createElement("label",{htmlFor:"body"},"Body:",a.a.createElement("textarea",{id:"body",value:n,onChange:this.handleBodyChange}))),a.a.createElement("button",{className:"btn"},"Save")))}}]),t}(r.Component),ve=function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(ie.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(a)))).handleSubmit=function(e){n.props.createSnippet(e),k("/home/snippets")},n}return Object(oe.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){return a.a.createElement("div",null,a.a.createElement("h3",null,"Create text snippet"),a.a.createElement(be,{onSubmit:this.handleSubmit}))}}]),t}(r.Component),ye=Object(s.b)(null,function(e){return{createSnippet:function(t){return e({type:"CREATE",payload:t})}}})(ve),Oe=function(e){function t(){var e,n;Object(v.a)(this,t);for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return(n=Object(ie.a)(this,(e=Object(se.a)(t)).call.apply(e,[this].concat(a)))).handleSubmit=function(e){var t=n.props.snippet.id;e=Object(p.a)({},e,{id:t}),n.props.updateSnippet(e),k("/home/snippets")},n}return Object(oe.a)(t,e),Object(y.a)(t,[{key:"render",value:function(){var e=this.props.snippet;return a.a.createElement("div",null,a.a.createElement("h2",null,"Edit snippet"),e&&a.a.createElement(be,{snippet:e,onSubmit:this.handleSubmit}))}}]),t}(r.Component);var Se=Object(s.b)(function(e,t){return{snippet:A(e,t.match.params.id)}},function(e){return{updateSnippet:function(t){return e({type:de,payload:t})}}})(Oe);var je=Object(s.b)(function(e,t){return{snippet:A(e,t.match.params.id)}})(function(e){var t=e.snippet;return a.a.createElement("div",null,t&&a.a.createElement("div",null,a.a.createElement("h2",null,t.title),a.a.createElement("div",null,t.body)))});function xe(e){var t=e.match.url;return a.a.createElement("div",null,a.a.createElement("div",{className:"header"},a.a.createElement("div",{className:"container"},a.a.createElement(ce.a,{to:"/home",className:"header__brand"},"IPFS text snippet editor"))),a.a.createElement("div",{className:"container"},a.a.createElement(ne.a,null,a.a.createElement(re.a,{exact:!0,path:"".concat(t),render:function(){return a.a.createElement(ae.a,{to:"".concat(t,"/snippets")})}}),a.a.createElement(re.a,{exact:!0,path:"".concat(t,"/snippets"),component:Ee}),a.a.createElement(re.a,{exact:!0,path:"".concat(t,"/snippets/new"),component:ye}),a.a.createElement(re.a,{exact:!0,path:"".concat(t,"/snippets/:id"),component:je}),a.a.createElement(re.a,{exact:!0,path:"".concat(t,"/snippets/:id/edit"),component:Se}),a.a.createElement(ae.a,{to:"/error"}))))}function we(){return a.a.createElement("div",{className:"container"},a.a.createElement("div",{className:"error-page"},a.a.createElement("h1",null,"Something went wrong"),a.a.createElement("div",null,"Start at ",a.a.createElement(ce.a,{to:"/"},"to home"))))}n(674),n(676),n(678);var Ne=Object(o.a)(),Ce=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.d)(Object(i.a)(Ne)),_e=Object(i.e)(d,Ce),ge=document.getElementById("root");if(!ge)throw new Error("couldn't find element with id root");Ne.run(ee),Object(c.render)(a.a.createElement(s.a,{store:_e},a.a.createElement("div",null,a.a.createElement(function(){return a.a.createElement(te.a,{history:T},a.a.createElement("div",null,a.a.createElement(ne.a,null,a.a.createElement(re.a,{path:"/home",component:xe}),a.a.createElement(re.a,{path:"/error",component:we}),a.a.createElement(ae.a,{to:"/home"}))))},null))),ge)}},[[292,2,1]]]);
//# sourceMappingURL=main.ef27bc3c.chunk.js.map